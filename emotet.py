import argparse
import base64


parser = argparse.ArgumentParser()
parser.add_argument("-b", "--base64", help="base64 string", required=True)
args = parser.parse_args()

powershell_code = base64.b64decode(args.base64).decode("utf-8")
formatted_code = powershell_code.replace("\00", "").replace(";", ";\n").replace("'http", "'\n\n\thttp").replace("/'.", 
        "/\n\n'.").replace("*http", "\n\thttp")

print()
print(formatted_code)
print()

safe_domain = formatted_code.replace("http", "hxxp").replace("www.", "www[.]").replace(".com", "[.]com").replace(".tech", 
        "[.]tech").replace(".online", "[.]online").replace(".sa", "[.]sa").replace(".xyz", "[.]xyz").replace(".club", "[.]club")

print()
print(safe_domain)
print()
